<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tuk.mina.dao.service.TbServiceDao">

        <select id="getService" resultType="TbServiceVo">
                SELECT * 
                FROM TB_MINA_SERVICE_L 
                WHERE 1=1 
                <if test="serviceId != null and serviceId != ''">
                        AND serviceId = #{serviceId}
                </if>
                <if test="serviceName != null and serviceName != ''">
                        AND serviceName = #{serviceName}
                </if>
                <if test="createUserId != null and createUserId != ''">
                        AND createUserId = #{createUserId}
                </if>
                <if test="createDttm != null and createDttm != ''">
                        AND createDttm = #{createDttm}
                </if>
                <if test="updatedDttm != null and updatedDttm != ''">
                        AND updatedDttm = #{updatedDttm}
                </if>
        </select>

        <insert id="newService" parameterType="TbServiceVo">
                IF NOT EXISTS (SELECT 1 FROM TB_MINA_SERVICE_L WHERE serviceName = #{serviceName})
                BEGIN
                        INSERT INTO TB_MINA_SERVICE_L (serviceName, iconPath, createUserId, createDttm, updatedDttm) 
                        VALUES (#{serviceName}, #{iconPath}, #{createUserId}, GETDATE(), GETDATE()) 
                END
        </insert>

        <update id="putService" parameterType="TbServiceVo">
                UPDATE TB_MINA_SERVICE_L 
                SET 
                <if test="serviceName != null and serviceName != ''">
                        serviceName = #{serviceName},
                </if>
                <if test="iconPath != null and iconPath != ''">
                        iconPath = #{iconPath},
                </if>
                updatedDttm = GETDATE()
                WHERE serviceId = #{serviceId}
        </update>

        <delete id="delService" parameterType="String">
                <if test="serviceId != null and serviceId != ''">
                        DELETE FROM TB_MINA_SERVICE_L 
                        WHERE serviceId = #{serviceId}
                </if>
        </delete>
</mapper>