<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tuk.mina.dao.team.TbTeamUserMapDao">

        <select id="getTeamUserMap" resultType="TbTeamUserMapVo">
                SELECT *
                FROM TB_MINA_TEAM_USER_M
                WHERE 1=1
                <if test="teamId != null and teamId != ''">
                        AND teamId = #{teamId}
                </if>
                <if test="userId != null and userId != ''">
                        AND userId = #{userId}
                </if>
                <if test="memberRole != null and memberRole != ''">
                        AND memberRole = #{memberRole}
                </if>
                <if test="memberStatus != null and memberStatus != ''">
                        AND memberStatus = #{memberStatus}
                </if>
                <if test="memberNick != null and memberNick != ''">
                        AND memberNick LIKE CONCAT('%', #{memberNick}, '%')
                </if>
                <if test="createDttm != null and createDttm != ''">
                        AND createDttm = #{createDttm}
                </if>
                <if test="updatedDttm != null and updatedDttm != ''">
                        AND updatedDttm = #{updatedDttm}
                </if>
        </select>

        <insert id="newTeamUserMap" parameterType="TbTeamUserMapVo">
                INSERT INTO TB_MINA_TEAM_USER_M (teamId, userId, memberRole, memberStatus, memberNick, createDttm, updatedDttm)
                VALUES (#{teamId}, #{userId}, #{memberRole}, #{memberStatus}, #{memberNick}, GETDATE(), GETDATE())
        </insert>

        <update id="putTeamUserMap" parameterType="TbTeamUserMapVo">
                UPDATE TB_MINA_TEAM_USER_M
                SET
                        <if test="memberRole != null and memberRole != ''">
                                memberRole = #{memberRole},
                        </if>
                        <if test="memberStatus != null and memberStatus != ''">
                                memberStatus = #{memberStatus},
                        </if>
                        <if test="memberNick != null and memberNick != ''">
                                memberNick = #{memberNick},
                        </if>
                        updatedDttm = GETDATE()
                WHERE teamId = #{teamId} AND userId = #{userId}
        </update>

        <delete id="delTeamUserMap">
                <if test="teamId == null AND teamId == '' AND userId == null AND userId == '' ">        
                        DELETE FROM TB_MINA_TEAM_USER_M
                        WHERE teamId = #{teamId} AND userId = #{userId}
                </if>
        </delete>
</mapper>